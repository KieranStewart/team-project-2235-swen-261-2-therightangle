title User adding a need to their funding basket

actor user
entryspacing 0.5
participantgroup #yellow Home View (HTML)
participantgroup #pink Cupboard (HTML)
participant Cupboard (component)
participant Need (component)
participant Need Details (component)

end
participant Funding Basket (component)
end
participant Funding Basket (Service)
participant Need Cache (Service)
participant Need (Service)
participantgroup #lightBlue Entire Backend
participant REST API (Backend)
end

note over user:Login successful
Funding Basket (component)->*Funding Basket (Service): <<creates>>
note over Funding Basket (Service):<<creates>>\ncontents: Need[]
Funding Basket (component)->Funding Basket (Service):Gets content 
activate Funding Basket (component)
activate Funding Basket (Service)
Funding Basket (component)<--Funding Basket (Service):return empty list
deactivate Funding Basket (component)
deactivate Funding Basket (Service)
Cupboard (component)->*Need (Service):<<creates>>
Cupboard (component)->*Need Cache (Service):<<creates>>
Cupboard (component)->Need (Service):getCupboard().subscribe
activate Cupboard (component)
activate Need (Service)
Need (Service)->REST API (Backend):HTTP request for all\nneeds in cupboard
activate REST API (Backend)
REST API (Backend)<-REST API (Backend):CupboardController
REST API (Backend)<-REST API (Backend):CupboardDAO
REST API (Backend)<-REST API (Backend):CupboardFileDAO
REST API (Backend)<<--REST API (Backend):Get Need[] from cupboard.json


Need (Service)<<--REST API (Backend):HTTP response with Need[]\nand 200 status code
deactivate REST API (Backend)

Cupboard (component)<<--Need (Service):return Need[]
deactivate Need (Service)
deactivate Cupboard (component)

loop #darkgray for each Need in Need[]
Cupboard (component)->Need (component):Make HTML button of need
activate Cupboard (component)
activate Need (component)
Cupboard (component)<--Need (component):Makes button with name\nof need as label
deactivate Cupboard (component)
deactivate Need (component)
end

user<-Cupboard (component):Shows list of HTML\nneeds button
loop   for each Need added to the funding basket
loop for each Need clicked on in the cupboard
user->Need (component):Clicks on a need HTML button
activate Need (component)
Need (component)->Need Cache (Service): showDetail()
deactivate Need (component)
activate Need Cache (Service)
Need Cache (Service)<-Need Cache (Service):selectedNeed = Need
Need Cache (Service)->Need Details (component):Sends this.selectedNeed
deactivate Need Cache (Service)

activate Need Details (component)
Need Details (component)<<--Need Details (component):update HTML\nwith selectedNeed\ninformation
alt #darkgray if selectedNeed.inFundingBasket is true
note over Need Details (component):hide the Add to funding basket (HTML button)\nand\nshow the Remove from funding basket (HTML button)\nand\nshow the donation amount entry
else else
note over Need Details (component):show the Add to funding basket (HTML button)\nand\nhide the Remove from funding basket (HTML button)\nand\nhide the donation amount entry
end
user<-Need Details (component):Show need's detail
deactivate Need Details (component)
end

user->Need Details (component):Click Add to funding basket (HTML button)
activate Need Details (component)

Need Details (component)->Funding Basket (Service):add(this.displayNeed: Need)
deactivate Need Details (component)
activate Funding Basket (Service)
Funding Basket (Service)->Funding Basket (Service):Set displayNeed.inFundingBasket\nto true
Funding Basket (Service)<-Funding Basket (Service):Add displayNeed\nto this.contents
Funding Basket (component)<--Funding Basket (Service):send updated contents
deactivate Funding Basket (Service)
activate Funding Basket (component)
Funding Basket (component)->Need (component):Make a HTML button of need
activate Need (component)
Funding Basket (component)<--Need (component):Makes button with name\nof need as label
deactivate Need (component)
user<-Funding Basket (component):Update list of HTML need buttons in the funding basket
deactivate Funding Basket (component)

end