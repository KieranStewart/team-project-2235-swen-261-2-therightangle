<div class="detail-container">
    <p>Detail section</p>
    <div *ngIf="needCacheService.selectedNeed != null">
        <!-- Display need information -->
        <h3>{{needCacheService.selectedNeed.name}}</h3>
        <h5 *ngIf="needCacheService.selectedNeed.type == 'donation'">Funding progress: ${{needCacheService.selectedNeed.progress}} / ${{needCacheService.selectedNeed.goal}}</h5>

        <div class="btn-group">
            <div *ngFor="let item of needCacheService.selectedNeed.tags">

                <button *ngIf="item != 'admin'" [disabled]="!loginService.userAccount.isAdmin" (click)="removeTag(item)">{{item}}</button>
            </div>
        </div>

        <!-- Admin-only tag modification -->
        <div *ngIf="loginService.userAccount.isAdmin">
            <button (click)="showTagList()">Toggle avaliable tags</button>
            <div *ngIf="showTags">
                <h4>All tags avaliable to be added to this need:</h4>
                <div class="btn-group">
                    <div *ngFor="let item of tagManagerContent">
                        <button (click)="addTag(item)">{{item}}</button>
                    </div>
                </div>
            </div>
            <h4 *ngIf="hoverTag != null">Tag Details: {{hoverTag.tagDetail}}</h4>
        </div>
        

        <h4 *ngIf="loginService.userAccount.isAdmin">{{tagMessage}}</h4>

        <h4>Description:</h4>
        <p>
            {{needCacheService.selectedNeed.description}}
        </p>
        <h5>Ends on {{needCacheService.selectedNeed.deadline.month}}/{{needCacheService.selectedNeed.deadline.day}}/{{needCacheService.selectedNeed.deadline.year}}</h5>
        <!-- If it isn't in the basket, allow it to be added -->
        <button *ngIf="!needCacheService.selectedNeed.inFundingBasket && !loginService.userAccount.isAdmin" (click)="addToFundingBasket()">Add to funding basket</button>

        <!-- If it is in the basket, allow it to be removed. Also allow its donation amounts to be modified.-->
        <div *ngIf="needCacheService.selectedNeed.inFundingBasket">
            <!-- Starter code for the Donate Time story.  Good luck! -->
            <div *ngIf="displayNeed != null && displayNeed.type == 'donation'">
              <label for="donation-amount">Donation amount: </label>
              <input id="donation-amount" [(ngModel)]="displayNeed.donationAmount" placeholder="0" #donationAmount />
            </div>
            
            <div *ngIf="displayNeed != null && displayNeed.type == 'volunteer'">
              <div *ngFor="let this_date of displayNeed.volunteerDates">
                    <app-date [date]="this_date" [need]="this.displayNeed"></app-date>
                    <button *ngIf="dateSelected(this_date)" (click)="removeDate(this_date)">[-]</button>
              </div>
            </div>
            <!-- <button (click)="saveNeed(donationAmount.value)"> Save </button> -->
            <button (click)="removeFromFundingBasket()">Remove from funding basket</button>
        </div>
        <!-- If I'm an admin, I see transactions -->
        <div *ngIf="transactionListVisible()">
            <app-transaction-history-display [displayNeed]="needCacheService.selectedNeed"></app-transaction-history-display>
        </div>
    </div>
    <div *ngIf="needCacheService.selectedNeed == null">
        <p><i>Select a need to see its details.</i></p>
    </div>
    <app-need-edit *ngIf="loginService.userAccount.isAdmin" [currentNeed]="needCacheService.selectedNeed"></app-need-edit>
</div>